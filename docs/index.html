<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>choose-your-own-adventure â€” Web</title>
  <meta name="description" content="Play the choose-your-own-adventure CLI game in the browser (React)"/>
  <link rel="icon" href="https://raw.githubusercontent.com/vannu07/choose-your-own-adventure/main/docs/favicon.ico" />
  <style>
    :root{--bg:#071024;--card:#082034;--accent:#06b6d4;--muted:#9fb6c6;color-scheme:dark}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071024 0%, #021025 100%);font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:#e6edf3}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{width:100%;max-width:980px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.04));border-radius:12px;padding:24px;box-shadow:0 12px 40px rgba(2,6,23,.6);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;gap:16px;align-items:center;margin-bottom:12px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#0ea5a4);display:flex;align-items:center;justify-content:center;font-weight:700;color:#00223a}
    h1{margin:0;font-size:1.4rem}
    .meta{color:var(--muted);font-size:.95rem;margin-top:6px}
    .preview{width:100%;max-height:260px;object-fit:cover;border-radius:8px;margin:14px 0}
    .game{display:grid;grid-template-columns:1fr 320px;gap:18px}
    @media (max-width:880px){.game{grid-template-columns:1fr}}
    .scene{background:rgba(255,255,255,0.02);padding:18px;border-radius:10px;min-height:220px;display:flex;flex-direction:column;gap:12px}
    .text{font-size:1.05rem;line-height:1.5}
    .choices{display:flex;flex-direction:column;gap:10px;margin-top:auto}
    button.choice{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.06));border:1px solid rgba(255,255,255,0.03);padding:10px 12px;border-radius:8px;color:inherit;text-align:left;cursor:pointer;transition:transform .12s,box-shadow .12s}
    button.choice:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(2,6,23,.45)}
    aside{background:rgba(0,0,0,0.03);padding:14px;border-radius:10px;min-height:220px}
    .history{font-size:.95rem;color:var(--muted);max-height:160px;overflow:auto}
    .controls{display:flex;gap:8px;margin-top:12px}
    .btn{padding:8px 10px;border-radius:8px;background:var(--accent);color:#00223a;border:none;cursor:pointer}
    .small{font-size:.9rem;padding:6px 8px}
    footer{margin-top:16px;color:var(--muted);font-size:.9rem;text-align:center}
    .badge{height:20px;margin-right:6px;vertical-align:middle}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main">
      <header>
        <div class="logo">CYOA</div>
        <div>
          <h1>ðŸŽ² choose-your-own-adventure â€” Web</h1>
          <div class="meta">A web UI for the CLI game â€” lightweight, responsive, and accessible.</div>
        </div>
      </header>

      <img class="preview" src="https://media.giphy.com/media/3o7TKtnuHOHHUjR38Y/giphy.gif" alt="preview animation">

      <div id="root" aria-live="polite"></div>

      <footer>
        <img class="badge" src="https://img.shields.io/badge/python-3.8%2B-blue" alt="python">
        <img class="badge" src="https://img.shields.io/badge/license-MIT-green" alt="license">
        &nbsp; â€¢ Live: <a href="https://vannu07.github.io/choose-your-own-adventure" target="_blank" rel="noopener" style="color:var(--accent)">vannu07.github.io/choose-your-own-adventure</a>
      </footer>
    </div>
  </div>

  <!-- React + Babel (dev CDN, fine for GH Pages demo). Replace with a build if you want production perf. -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Embedded story (convert your YAML later or fetch JSON)
    const STORY = {
      start: {
        id: 'start',
        title: 'A Dark Forest',
        text: "You wake up in a dark forest. Mist curls between the ancient trees. Two paths lie ahead.",
        choices: [
          { id: 'left', label: 'Take the left path' },
          { id: 'right', label: 'Take the right path' }
        ]
      },
      left: {
        id: 'left',
        title: 'Abandoned Cabin',
        text: "You find an abandoned cabin. A faint light flickers inside.",
        choices: [
          { id: 'enter', label: 'Enter the cabin' },
          { id: 'back', label: 'Go back to the fork' }
        ]
      },
      right: {
        id: 'right',
        title: 'Rushing River',
        text: "A rushing river blocks the path. A rickety bridge sways in the wind.",
        choices: [
          { id: 'cross', label: 'Cross the bridge' },
          { id: 'back', label: 'Return to the fork' }
        ]
      },
      enter: {
        id: 'enter',
        title: 'Warm Hearth',
        text: "Inside, a friendly fire and a warm stew await. You are safe... for now.",
        choices: [{ id: 'end', label: 'Rest (End)' }]
      },
      cross: {
        id: 'cross',
        title: 'On the Other Side',
        text: "You safely cross and find a small village. The adventure continues elsewhere.",
        choices: [{ id: 'end', label: 'Celebrate (End)' }]
      },
      back: { id: 'start', redirect: 'start' },
      end: { id: 'end', title: 'The End', text: "Thank you for playing this demo.", choices: [{ id: 'restart', label: 'Play again' }] },
      restart: { id: 'start', redirect: 'start' }
    };

    function resolveScene(id) {
      const item = STORY[id];
      if (!item) return STORY.start;
      if (item.redirect) return STORY[item.redirect];
      return item;
    }

    function Game() {
      const [sceneId, setSceneId] = useState('start');
      const [history, setHistory] = useState([]);
      const scene = resolveScene(sceneId);
      const choicesRef = useRef(null);

      useEffect(() => {
        // focus first choice for keyboard accessibility
        const btn = choicesRef.current?.querySelector('button');
        if (btn) btn.focus();
      }, [sceneId]);

      function choose(choiceId) {
        const next = resolveScene(choiceId);
        setHistory(h => [...h, { id: scene.id, title: scene.title }]);
        setSceneId(next.id);
      }

      function restart() {
        setHistory([]);
        setSceneId('start');
      }

      return (
        <div className="game" role="application" aria-label="Choose your own adventure">
          <div className="scene" aria-live="polite">
            <div style={{fontSize:'.95rem',color:'#9fb6c6'}}>{scene.title}</div>
            <div className="text">{scene.text}</div>

            <div className="choices" ref={choicesRef}>
              {scene.choices && scene.choices.map((c, i) => {
                // resolve redirect choices that map to other scenes like 'back' or 'restart'
                const targetId = resolveScene(c.id).id || c.id;
                const label = c.label || c.id;
                return (
                  <button
                    key={i}
                    className="choice"
                    onClick={() => {
                      if (c.id === 'restart' || c.id === 'end') return restart();
                      choose(c.id);
                    }}
                    aria-label={label}
                  >
                    {label}
                  </button>
                );
              })}
            </div>

            <div className="controls" style={{marginTop:12}}>
              <button className="btn small" onClick={() => { navigator.clipboard?.writeText(window.location.href); }} title="Copy URL">Share</button>
              <button className="btn small" onClick={restart} title="Restart">Restart</button>
            </div>
          </div>

          <aside>
            <div style={{fontWeight:700}}>History</div>
            <div className="history" aria-live="polite">
              {history.length === 0 ? <div style={{color:'#9fb6c6'}}>No moves yet</div> : history.map((h, i) => <div key={i}>â†’ {h.title || h.id}</div>)}
            </div>
            <div style={{marginTop:12}}>
              <div style={{fontSize:'.9rem',color:'#9fb6c6'}}>About</div>
              <div style={{fontSize:'.9rem',marginTop:6}}>
                This is a React frontend demo for your CLI adventure. To connect the real Python engine, either:
                <ul>
                  <li>Pre-generate JSON story files and fetch them here, or</li>
                  <li>Run the Python game server and call it via REST, or</li>
                  <li>Use Pyodide to run the Python engine in-browser.</li>
                </ul>
              </div>
            </div>
          </aside>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<Game />);
  </script>
</body>
</html>